{
  "tools": [
    {
      "name": "list_tables",
      "description": "List all tables available in the connected PostgreSQL database",
      "inputSchema": {
        "type": "object",
        "properties": {},
        "required": []
      }
    },
    {
      "name": "list_extensions",
      "description": "List all installed PostgreSQL extensions",
      "inputSchema": {
        "type": "object",
        "properties": {},
        "required": []
      }
    },
    {
      "name": "list_migrations",
      "description": "List applied database migrations",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table_name": {
            "type": "string",
            "description": "Migrations table name (defaults to 'schema_migrations')"
          }
        },
        "required": []
      }
    },
    {
      "name": "apply_migration",
      "description": "Apply a SQL migration against the connected database",
      "inputSchema": {
        "type": "object",
        "properties": {
          "sql": {
            "type": "string",
            "description": "The SQL migration to execute"
          },
          "name": {
            "type": "string",
            "description": "Optional migration name or label"
          }
        },
        "required": ["sql"]
      }
    },
    {
      "name": "execute_sql",
      "description": "Execute a raw SQL query against the connected database",
      "inputSchema": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "The SQL query to execute"
          },
          "driver": {
            "type": "string",
            "enum": ["athena", "postgresql", "supabase"],
            "description": "Driver to use (defaults to 'postgresql')"
          },
          "db_name": {
            "type": "string",
            "description": "Optional database name (used by /query/sql)"
          }
        },
        "required": ["query"]
      }
    },
    {
      "name": "get_logs",
      "description": "Retrieve recent database or application logs",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table_name": {
            "type": "string",
            "description": "Logs table name (defaults to 'logs')"
          },
          "limit": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum number of log rows to return (defaults to 100)"
          },
          "level": {
            "type": "string",
            "pattern": "^[a-zA-Z0-9_-]+$",
            "description": "Filter by log level (e.g. 'error', 'warn', 'info')"
          }
        },
        "required": []
      }
    },
    {
      "name": "get_columns_of_table",
      "description": "Describe columns for a table using Athena's schema API",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": {
            "type": "string",
            "description": "Table name (optionally schema-qualified) to describe"
          },
          "schema": {
            "type": "string",
            "description": "Optional schema name when the table name is not schema-qualified"
          }
        },
        "required": ["table"]
      }
    },
    {
      "name": "list_table_metadata",
      "description": "Return schema/table metadata plus column defaults and nullability",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": {
            "type": "string",
            "description": "Table name (optionally schema-qualified)"
          },
          "schema": {
            "type": "string",
            "description": "Optional schema name when the table name is not schema-qualified"
          }
        },
        "required": ["table"]
      }
    },
    {
      "name": "list_schemas",
      "description": "List database schemas visible to the current Athena client",
      "inputSchema": {
        "type": "object",
        "properties": {
          "include_system": {
            "type": "boolean",
            "description": "Include pg_catalog and information_schema schemas"
          }
        },
        "required": []
      }
    },
    {
      "name": "list_views",
      "description": "List visible views (and optionally materialized views)",
      "inputSchema": {
        "type": "object",
        "properties": {
          "schema": {
            "type": "string",
            "description": "Schema to limit the view lookup to"
          },
          "include_materialized": {
            "type": "boolean",
            "description": "Include materialized views defined in pg_matviews"
          }
        },
        "required": []
      }
    },
    {
      "name": "get_row_by_eq_column_of_table",
      "description": "Fetch rows where a column equals a value using Athena's fetch endpoint",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": {
            "type": "string",
            "description": "Table name to query (optionally schema-qualified)"
          },
          "column": {
            "type": "string",
            "description": "Column name to match against"
          },
          "value": {
            "oneOf": [
              { "type": "string" },
              { "type": "number" },
              { "type": "boolean" }
            ],
            "description": "Value to compare (converted to string for Athena)"
          },
          "schema": {
            "type": "string",
            "description": "Optional schema to override the table name"
          },
          "limit": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum number of rows to return (defaults to 100)"
          }
        },
        "required": ["table", "column", "value"]
      }
    },
    {
      "name": "list_foreign_keys",
      "description": "List primary keys, foreign keys, and unique constraints for a table. Essential for understanding relationships and correct joins.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": { "type": "string", "description": "Table name (optionally schema-qualified)" },
          "schema": { "type": "string", "description": "Optional schema when table name is not schema-qualified" }
        },
        "required": ["table"]
      }
    },
    {
      "name": "get_table_sample",
      "description": "Sample rows from a table to understand its data shape. Quick alternative to writing SQL.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": { "type": "string", "description": "Table name (optionally schema-qualified)" },
          "schema": { "type": "string", "description": "Optional schema when table name is not schema-qualified" },
          "limit": { "type": "integer", "minimum": 1, "description": "Number of rows to sample (defaults to 10)" }
        },
        "required": ["table"]
      }
    },
    {
      "name": "list_indexes",
      "description": "List index definitions for a table. Helps with performance and query design.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": { "type": "string", "description": "Table name (optionally schema-qualified)" },
          "schema": { "type": "string", "description": "Optional schema when table name is not schema-qualified" }
        },
        "required": ["table"]
      }
    },
    {
      "name": "search_columns",
      "description": "Find tables and columns by name pattern. Speeds up schema discovery.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "pattern": { "type": "string", "description": "Column or table name pattern (SQL LIKE, use % for wildcard)" },
          "schema": { "type": "string", "description": "Optional schema to limit search" }
        },
        "required": ["pattern"]
      }
    },
    {
      "name": "get_row_by_id",
      "description": "Fetch rows by primary key column value. Simplifies the common fetch-by-id use case.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": { "type": "string", "description": "Table name (optionally schema-qualified)" },
          "id": { "oneOf": [{ "type": "string" }, { "type": "number" }], "description": "Primary key value (typically id)" },
          "id_column": { "type": "string", "description": "Primary key column name (defaults to 'id')" },
          "schema": { "type": "string", "description": "Optional schema when table name is not schema-qualified" },
          "limit": { "type": "integer", "minimum": 1, "description": "Maximum rows to return (defaults to 100)" }
        },
        "required": ["table", "id"]
      }
    },
    {
      "name": "list_all_table_metadata",
      "description": "Return metadata for all tables in one call: schema, name, columns, types, defaults, nullable. Single overview of the whole schema.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "schema": { "type": "string", "description": "Optional schema to limit to (default: all user schemas)" }
        },
        "required": []
      }
    },
    {
      "name": "insert_row",
      "description": "Insert a row into a table. Blocked when read_only mode is enabled.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": { "type": "string", "description": "Table name (optionally schema-qualified)" },
          "data": { "type": "object", "additionalProperties": { "oneOf": [{ "type": "string" }, { "type": "number" }, { "type": "boolean" }, { "type": "null" }] }, "description": "Row data as key-value pairs" },
          "schema": { "type": "string", "description": "Optional schema when table name is not schema-qualified" }
        },
        "required": ["table", "data"]
      }
    },
    {
      "name": "delete_row",
      "description": "Delete a row by primary key (resource_id). Blocked when read_only mode is enabled.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": { "type": "string", "description": "Table name (optionally schema-qualified)" },
          "resource_id": { "type": "string", "description": "Primary key value of the row to delete" },
          "schema": { "type": "string", "description": "Optional schema when table name is not schema-qualified" }
        },
        "required": ["table", "resource_id"]
      }
    },
    {
      "name": "update_row",
      "description": "Update rows matching a condition. Blocked when read_only mode is enabled.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "table": { "type": "string", "description": "Table name (optionally schema-qualified)" },
          "set": { "type": "object", "additionalProperties": { "oneOf": [{ "type": "string" }, { "type": "number" }, { "type": "boolean" }, { "type": "null" }] }, "description": "Column-value pairs to set" },
          "where_column": { "type": "string", "description": "Column to match in WHERE clause" },
          "where_value": { "oneOf": [{ "type": "string" }, { "type": "number" }, { "type": "boolean" }], "description": "Value to match (converted to string)" },
          "schema": { "type": "string", "description": "Optional schema when table name is not schema-qualified" }
        },
        "required": ["table", "set", "where_column", "where_value"]
      }
    }
  ]
}
